<!--
  Generated template for the VehiclePage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-title>
      <span (click)="loadVehicle(this.vehicleId)" *ngIf="!this.loadedVehicle">Vehículo</span>
      <span (click)="loadVehicle(this.vehicleId)" *ngIf="this.loadedVehicle">{{ vehicle.brand }} {{ vehicle.model }}</span>
      <img src="assets/imgs/loading.gif" width="30" *ngIf="this.loadingVehicle && this.loadedVehicle" style="vertical-align:middle">
    </ion-title>
    <ion-buttons end>
      <button
        ion-button
        block
        color="primary"
        *ngIf="!this.loading"
        (click)="goToEditVehiclePage()">Editar</button>
    </ion-buttons>
  </ion-navbar>

</ion-header>

<ion-content padding>

  <span *ngIf="this.loadingVehicle && !this.loadedVehicle" style="text-align: center !important;">
    <img src="assets/imgs/loading.gif" width="80" style="display: block; margin: 0 auto;">
  </span>

  <div *ngIf="this.loadedVehicle">

    <div *ngFor="let error of this.errorsLoadingVehicle; let i = index">
      <span>{{ error }}</span>
    </div>

    <ion-card>
      <ion-item>
        <ion-grid>
          <ion-row>
            <ion-col>
              <img src= "assets/imgs/CarIcon.png">
            </ion-col>
            <ion-col>
              <ion-row>
                <ion-col col-12>
                  <ion-row>
                    <font size='2' color=#7A7A7A>{{ vehicle.sharing_status }}</font>
                  </ion-row>
                  <ion-row>
                    <ion-row>
                      {{ vehicle.brand }} {{ vehicle.model }}
                    </ion-row>
                  </ion-row>
                  <ion-row padding-top="100px">
                    <font color= "tertiary" size='2' *ngFor="let financialStatus of vehicle.balances; let i = index">
                      <span padding-top="100px" *ngIf="financialStatus.balance > 0.0">
                        <font color= "primary" size='2'>{{ financialStatus.user.name }} te debe {{ financialStatus.balance }} €</font>
                      </span>
                      <span padding-top="100px" *ngIf="financialStatus.balance === 0.0">
                        <font color= "primary" size='2'>Debes {{ (financialStatus.balance * (-1)) }} € a {{ financialStatus.user.name }}</font>
                      </span>
                      <span padding-top="100px" *ngIf="financialStatus.balance < 0.0">
                        <font color= "tertiary" size='2'>Debes {{ (financialStatus.balance * (-1)) }} € a {{ financialStatus.user.name }}</font>
                      </span>
                    </font>
                  </ion-row>
                </ion-col>
              </ion-row>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>
    </ion-card>

    <div style="text-align: center">
      <button
        ion-button
        color="primary"
        style="width: 45%; display: inline"
        (click)="goToNewOutgoPage()">Registrar un gasto</button>
      <button
        ion-button
        color="primary"
        style="width: 45%; display: inline"
        (click)="goToNewPaymentPage()">Registrar un pago</button>
    </div>

    <div *ngFor="let action of this.vehicle.actions; let i = index" (click)="goToPage(action.type, action)">

      <div *ngIf="i == 0" style="padding-top: 5px">
        {{ action.formattedDate }}
      </div>
      <div *ngIf="i > 0" style="padding-top: 5px">
        <span *ngIf="action.differentDay">
          {{ action.formattedDate }}
        </span>
      </div>

      <ion-card>
        <ion-item>
          <ion-grid>
            <ion-row *ngIf="action.type === 'outgo'">
              <ion-col padding-top = "2px" col-10>
                Gasto <font color="primary">{{ action.quantity }} €</font>
                <br> <font size='2' color=#7A7A7A>{{ action.explanation }}</font>
              </ion-col>
              <ion-col col-2>
                <ion-icon class="icons" size="large" name="pricetag" slot="start"></ion-icon>
              </ion-col>
            </ion-row>
            <ion-row *ngIf="action.type === 'payment'">
              <ion-col padding-top = "2px" col-10>
                Pago <font color="primary">{{ action.quantity }} €</font>
                <br> <font size='2' color=#7A7A7A>{{ action.explanation }}</font>
              </ion-col>
              <ion-col col-2>
                <ion-icon class="icons" size="large" name="cash" slot="start"></ion-icon>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-item>
      </ion-card>

    </div>




  </div>








</ion-content>
